#!/usr/bin/env bash
# Environment file for QNX SDP 8.0.0 in Docker container
#
# Usage (in Docker container linuxserver-kde-tatsuyai):
#   source ~/qnx800/qnxsdp-env.sh
#   cd ~/host_home/repos/Adaptive-AUTOSAR
#   source qnx/env/qnx800.env

# QNX SDP 8.0.0 location (/home/tatsuyai/qnx800 in container)
export QNX_HOST="${HOME}/qnx800/host/linux/x86_64"
export QNX_TARGET="${HOME}/qnx800/target/qnx"

# Build target architecture (aarch64le for ARM64 / Raspberry Pi, x86_64 for Intel)
export AUTOSAR_QNX_ARCH="${AUTOSAR_QNX_ARCH:-aarch64le}"

# Parallel jobs (auto-limited by available memory to prevent OOM)
# Override if needed: export AUTOSAR_QNX_JOBS=2
# export AUTOSAR_QNX_JOBS="$(getconf _NPROCESSORS_ONLN 2>/dev/null || echo 4)"

# Output layout (system-wide installation to /opt/qnx)
export AUTOSAR_QNX_OUT_ROOT="/opt/qnx"
export AUTOSAR_QNX_3P_PREFIX="${AUTOSAR_QNX_OUT_ROOT}/third_party"
export AUTOSAR_QNX_MW_PREFIX="${AUTOSAR_QNX_OUT_ROOT}"
export AUTOSAR_QNX_PREFIX="${AUTOSAR_QNX_OUT_ROOT}/autosar_ap/${AUTOSAR_QNX_ARCH}"

# Work directory (build artifacts)
export AUTOSAR_QNX_WORK_ROOT="${PWD}/out/qnx/work"

# Optional host tools path if built via qnx/scripts/build_host_tools.sh
export PATH="${AUTOSAR_QNX_OUT_ROOT}/host-tools/bin:${PATH}"

echo "[QNX ENV] Configured for QNX 8.0.0"
echo "          QNX_HOST=${QNX_HOST}"
echo "          QNX_TARGET=${QNX_TARGET}"
echo "          AUTOSAR_QNX_ARCH=${AUTOSAR_QNX_ARCH}"
echo "          AUTOSAR_QNX_OUT_ROOT=${AUTOSAR_QNX_OUT_ROOT}"
